// Initialize variables
let quoteItems = [];
let totalAmount = 0;

// DOM Elements
const itemForm = document.getElementById('itemForm');
const quoteList = document.getElementById('quoteList');
const totalAmountDisplay = document.getElementById('totalAmount');
const completeTransactionBtn = document.getElementById('completeTransaction');
const historyList = document.getElementById('historyList');

// Add item to quote
itemForm.addEventListener('submit', function (e) {
  e.preventDefault();

  const itemName = document.getElementById('itemName').value;
  const itemCondition = document.getElementById('itemCondition').value;
  const itemPrice = parseFloat(document.getElementById('itemPrice').value);

  // Add item to quote
  quoteItems.push({ itemName, itemCondition, itemPrice });
  totalAmount += itemPrice;

  // Update UI
  updateQuoteDisplay();
  itemForm.reset();
});

// Update quote display
function updateQuoteDisplay() {
  quoteList.innerHTML = '';
  quoteItems.forEach(item => {
    const li = document.createElement('li');
    li.textContent = `${item.itemName} (${item.itemCondition}): $${item.itemPrice.toFixed(2)}`;
    quoteList.appendChild(li);
  });
  totalAmountDisplay.textContent = totalAmount.toFixed(2);
}

// Complete transaction
completeTransactionBtn.addEventListener('click', function () {
  if (quoteItems.length === 0) {
    alert('No items in the quote!');
    return;
  }

  // Add to transaction history
  const transaction = {
    date: new Date().toLocaleString(),
    items: [...quoteItems],
    total: totalAmount
  };

  // Save to localStorage (or Firebase/Google Sheets later)
  saveTransaction(transaction);

  // Update history display
  updateHistoryDisplay();

  // Reset quote
  quoteItems = [];
  totalAmount = 0;
  updateQuoteDisplay();
});

// Save transaction to localStorage
function saveTransaction(transaction) {
  let history = JSON.parse(localStorage.getItem('transactionHistory')) || [];
  history.push(transaction);
  localStorage.setItem('transactionHistory', JSON.stringify(history));
}

// Update transaction history display
function updateHistoryDisplay() {
  historyList.innerHTML = '';
  const history = JSON.parse(localStorage.getItem('transactionHistory')) || [];
  history.forEach(transaction => {
    const li = document.createElement('li');
    li.textContent = `${transaction.date} - Total: $${transaction.total.toFixed(2)}`;
    historyList.appendChild(li);
  });
}

// Load history on page load
updateHistoryDisplay();